(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{4853:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return E}});var s=t(9439),i=t(3433),c=t(3878),a=t(9199),r=t(181),o=t(5267);var l=t(7294),u=t(9008),d=t(8594),h=t(2153),f=t.n(h),m=t(8134),v=t.n(m),p=t(5893),g=function(e){return v()(f()(e).toString().slice(0,8))},x=function(e){return""===e.replace(/^\s+/,"").replace(/\s+$/,"")},j=function(e,n){var t,s="anon",i=x(n)?g(e):g(n);if(n.includes("#")){var l=n.split("#"),u=(t=l,(0,c.Z)(t)||(0,a.Z)(t)||(0,r.Z)(t)||(0,o.Z)()),d=u[0],h=u.slice(1).join("#");s=x(d)?s:d,i=x(h)?g(e):g(h)}return{name:s,trip:i}},N="-".repeat((new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).length),w=/((?:ftp|http|https):\/\/(?:\w+:{0,1}\w*@)?(?:\S+)(?::[0-9]+)?(?:\/|\/(?:[\w#!:.?+=&%@!-/]))?)/,S=function(e){for(var n=e.split(w),t=1;t<n.length;t+=2)n[t]=(0,p.jsx)("a",{href:"".concat(n[t]),target:"_blank",rel:"noreferrer",style:{color:"#bbf",fontWeight:"bold"},children:n[t]},"link"+t);return n},b=(0,l.memo)((function(e){var n=e.message,t=n.name,s=n.trip,i=n.content,c=n.time,a=n.active,r=(0,l.useState)(N),o=r[0],u=r[1];(0,l.useEffect)((function(){u(new Date(c).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}),[c]);var d=(0,l.useState)([]),h=d[0],f=d[1];(0,l.useEffect)((function(){f(i.replace(/^\s+|\s+$/g,"").replace(/ {2}/g," \xa0").split("\n").map(S))}),[i]);var m=(0,l.useState)("#FFFFFF"),v=m[0],g=m[1];(0,l.useEffect)((function(){g(k(s))}),[s]);var x=t&&t.length>0?t:s,j=(0,p.jsxs)("span",{className:"tooltip",style:{color:v},children:[(0,p.jsx)("span",{style:{background:a?"".concat(v,"55"):"inherit"},children:x}),(0,p.jsx)("span",{className:"tooltiptext",children:s})]});return(0,p.jsxs)("div",{className:"message",children:[(0,p.jsxs)("div",{className:"meta",children:[(0,p.jsx)("span",{className:"time",children:o})," ",j,"\xa0"]}),(0,p.jsx)("div",{className:"content",children:h.map((function(e,n){return(0,p.jsxs)("div",{className:"text",children:[e,(0,p.jsx)("br",{})]},n)}))})]})})),_=function(e){var n=e.onMessageSubmit,t=(0,l.useState)(""),s=t[0],i=t[1];return(0,p.jsx)("textarea",{className:"messageInput preventToggle",placeholder:"Say something",value:s,onChange:function(e){i(e.target.value)},onKeyDown:function(e){if(13===e.keyCode&&!1===e.shiftKey){if(e.preventDefault(),x(s))return;i(""),n(e,s)}}})},y=function(e){var n=e.connections;return(0,p.jsxs)("div",{className:"connectionsBox",children:[(0,p.jsx)("div",{style:{textAlign:"center",borderBottom:"thin solid green",paddingBottom:"0.5em",marginBottom:"0.5em"},children:"Connections"}),Object.keys(n).map((function(e,t){var s=n[e];return(0,p.jsxs)("div",{className:"connection",children:[(0,p.jsx)("div",{className:"connectionName",style:{color:k(s.trip)},children:s.name}),(0,p.jsx)("div",{className:"connectionTrip",children:s.trip})]},t)}))]})},k=function(e){var n=0;if(0===e.length)return n;for(var t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n),n&=n;for(var s="#",i=0;i<3;i++){var c=n>>8*i&255;s+=("00"+(c|=80).toString(16)).substr(-2)}return s},E=function(){var e=(0,l.useState)(null),n=e[0],t=e[1],c=(0,l.useState)(""),a=c[0],r=c[1],o=(0,l.useState)([]),h=o[0],f=o[1],m=(0,l.useState)({}),v=m[0],g=m[1],x=(0,l.useState)(""),N=x[0],w=x[1];(0,l.useEffect)((function(){t((0,d.Z)("https://chat.soma.cx",{path:"/socket.io/",withCredentials:!0}))}),[]),(0,l.useEffect)((function(){if(null!==n)return n.on("connected",(function(e){var n=e.id,t=e.chat,s=e.connections;console.log("You connected with connection ID =",n),r(n),g(s),f(t)})),n.on("user left",(function(e){var n=e.id,t=e.connections;console.log("User ".concat(n," left.")),g(t)})),n.on("message",(function(e){var n=e.packet,t=e.connections;f((function(e){return[].concat((0,i.Z)(e),[n])})),g(t)})),n.on("wipe old messages",(function(e){var n=e.chat;f((0,i.Z)(n))})),function(){n.emit("leave")}}),[n]);var S=j(a,N),E=S.name,C=S.trip;return n&&!1!==n.connected?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(u.default,{children:[(0,p.jsx)("title",{children:"somachat"}),(0,p.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"},"direct")]}),(0,p.jsxs)("div",{className:"chat",children:[(0,p.jsxs)("div",{className:"header",children:[(0,p.jsx)("div",{className:"txt",children:"/chat - tripcode chat"}),(0,p.jsxs)("div",{className:"generator",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("span",{style:{color:k(C)},children:E})," ",C,"\xa0"]}),(0,p.jsx)("input",{className:"secretInput preventToggle",placeholder:"name#secret (optional)",onChange:function(e){var n=e.target.value;if("#"===n[n.length-1]&&!n.slice(0,n.length-1).includes("#")&&n.length-1>10){var t=n.split("");t.splice(10,t.length-10),n=t.join("")+"#"}if(n.includes("#")){var i=n.split("#");if((0,s.Z)(i,1)[0].length>10)return}w(n)},value:N})]})]}),(0,p.jsx)("br",{}),(0,p.jsxs)("div",{className:"theFlex",children:[(0,p.jsx)("div",{className:"messages",children:(0,i.Z)(h).reverse().map((function(e){return(0,p.jsx)(b,{message:e},"".concat(a,":").concat(e.time))}))}),(0,p.jsx)(y,{connections:v})]}),(0,p.jsx)(_,{onMessageSubmit:function(e,t){n.emit("message",{secret:N,content:t})}})]})]}):(0,p.jsx)("div",{style:{padding:"1em"},children:"Chat is down..."})}},8752:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return t(4853)}])},2480:function(){}},function(e){e.O(0,[871,96,706,774,888,179],(function(){return n=8752,e(e.s=n);var n}));var n=e.O();_N_E=n}]);